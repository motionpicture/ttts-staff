<div class="wrapper-searchform">
    <form class="search-form" action="/staff/mypage/search">
    <input type="hidden" name="limit" value="20">

    <table class="table" bordered>
        <tbody>
            <tr>
                <td colspan="5">
                    <%- __('Label.Day') %><br>
                    <div class="form-group">
                        <select class="form-control" name="day" style="width:auto;display:inline-block;" >
                            <option value=""><%- __('Label.AllDay') %></option>
                            <%
                            //let now = moment();
                            //let start = moment(conf.get('datetimes.event_start'));
                            //let end = moment(conf.get('datetimes.event_end'));
                            let today = moment();
                            let start = (moment(today.toDate())).add(-3, 'months');
                            let end = (moment(today.toDate())).add(3, 'months');
                            let options = '';
                            let index = 0;
                            while (start.format('YYYYMMDD') <= end.format('YYYYMMDD')) {
                                let selected = (start.format('YYYYMMDD') == today.format('YYYYMMDD')) ? "selected" : "";
                                index++;
                                options += `<option value="${start.format('YYYYMMDD')}" ${selected}>${start.format('YYYY/MM/DD')}</option>`;
                                start = start.add(+1, 'days');
                                continue;
                            }
                            %>
                            <%- options %>
                        </select>
                        <%- /* 開始時刻 */ %>
                        <select class="form-control" name="start_hour1" style="width:auto;display:inline-block;">
                            <option value=""></option>
                            <option value="09">09</option>
                            <option value="10">10</option>
                        </select>
                        <%- __('Label.Hour') %>
                        <select class="form-control" name="start_minute1" style="width:auto;display:inline-block;">
                            <option value=""></option>
                            <option value="00">00</option>
                            <option value="15">15</option>
                            <option value="30">30</option>
                            <option value="45">45</option>
                        </select>
                        <%- __('Label.Minute') %>
                        <%- __('Label.FromTo') %>
                        <%- /* 終了時刻 */ %>
                        <select class="form-control" name="start_hour2" style="width:auto;display:inline-block;">
                            <option value=""></option>
                            <option value="09">09</option>
                            <option value="10">10</option>
                            <option value="11">11</option>
                            <option value="12">12</option>
                            <option value="13">13</option>
                        </select>
                        <%- __('Label.Hour') %>
                        <select class="form-control" name="start_minute2" style="width:auto;display:inline-block;">
                            <option value=""></option>
                            <option value="00">00</option>
                            <option value="15">15</option>
                            <option value="30">30</option>
                            <option value="45">45</option>
                        </select>
                        <%- __('Label.Minute') %>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="5">
                    <p name='error_day' class="error-message" style="color:red;padding:0 0 0 0;"></p>
                    <p name='error_start_hour1' class="error-message" style="color:red;padding:0 0 0 0;"></p>
                    <p name='error_start_hour2' class="error-message" style="color:red;padding:0 0 0 0;"></p>
                </td>
            </tr>
            <tr>
                <td>
                    購入番号から検索<br>
                    <%- __('Label.PaymentNo') %><br>
                    <div class="form-group">
                        <input type="text" class="form-control" name="payment_no" style="width:90%;">
                    </div>
                </td>
                <td>
                    アカウントから検索<br><br>
                    <div class="form-group">
                        <select class="form-control" name="owner" style="width:auto;">
                            <option value=""></option>
                            <% owners.forEach((owner) => { %>
                            <option value="<%= owner._id %>"><%= owner['name'][locale] %></option>
                            <% }) %>
                        </select>
                    </div>
                </td>
                <td>
                </td>
                <td>
                </td>
            </tr>
            <tr>
                <td>
                    購入者情報から検索<br>
                    お名前(姓)<br>
                    <div class="form-inline">
                        <div class="form-group">
                            <input type="text" class="form-control" name="purchaser_last_name" style="width:90%;">
                        </div>
                    </div>
                </td>
                <td>
                    <br>
                    (名)<br>
                    <div class="form-inline">
                        <div class="form-group">
                            <input type="text" class="form-control" name="purchaser_first_name" style="width:90%;">
                        </div>
                    </div>
                </td>
                <td>
                    <br>
                    メールアドレス<br>
                    <div class="form-inline">
                        <div class="form-group">
                            <input type="text" class="form-control" name="purchaser_email" style="width:90%;">
                        </div>
                    </div>
                </td>
                <td>
                    <br>
                    電話番号<br>
                    <div class="form-inline">
                        <div class="form-group">
                            <input type="text" class="form-control" name="purchaser_tel" style="width:90%;">
                        </div>
                    </div>
                </td>
                <td>
                    <br>
                    メモ<br>
                    <div class="form-group">
                        <input type="text" class="form-control" name="watcher_name" style="width:90%;">
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="5">
                    <div class="form-group">
                        <a class="btn" href="javascript:void(0)" style="float:none;"><span><%- __('Button.Search') %></span></a>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    </form>
</div>

<p class="row">About <span class="total-count"></span> results</p>

<div class="wrapper-reservations">
    <table class="table table-bordered">
        <thead>
            <tr>
                <th><input type="checkbox" class="check-all"></th>
                <th><%- __('Label.PaymentNo') %></th>
                <th>氏名</th>
                <th>メモ</th>
                <th><%- __('Label.SeatCode') %></th>
                <th>券種</th>
                <th></th>
            </tr>
        </thead>
        <tbody id="reservations">

        </tbody>
    </table>
</div>



<div class="wrapper-controls">

    <div class="form-inline">
        <div class="form-group">
            <select class="form-control" name="action">
                <option value=""><%- __('Label.Actions') %></option>
                <option value="cancel"><%- __('Label.Cancel') %></option>
                <option value="print"><%- __('Label.Print') %></option>
            </select>
        </div>
        <div class="form-group">
            <p class="btn action-to-reservations"><span><%- __('Label.Apply') %></span></p>
        </div>
    </div>

    <div class="navigation">
    </div>

</div>





<div class="modal modal-cancel fade cancel-reservation-confirm" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <p class="btn-circle-close" data-dismiss="modal"></p>

            <div class="modal-body">
                <h2><%- __('Label.ConfirmCancel') %></h2>
                <table class="table table-reservation-confirm">
                </table>
                <p class="text message"><%- __('Message.AreYouSureCancel') %></p>
                <div class="btns2clm">
                    <p class="btn btn-lg btn-next btn-exec execute-cancel" data-url=""><span><%- __('Button.Yes') %></span></p>
                    <p class="btn btn-lg btn-back" data-dismiss="modal"><span><span><%- __('Button.No') %></span></p>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal modal-cancel fade cancel-reservation-complete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <p class="btn-circle-close" data-dismiss="modal"></p>

            <div class="modal-body">
                <h2><%- __('Label.CompleteCancel') %></h2>
                <%- __('Message.CompleteCancel') %>
            </div>

            <div class="modal-footer">
                <p class="btn btn-close" data-dismiss="modal"><span><%- __('Button.Close') %></span></p>
            </div>
        </div>
    </div>
</div>

<div class="modal fade loading" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <div class="text-center"><%- __('Message.Searching') %></div>
            </div>
        </div>
    </div>
</div>

<input type="hidden" name="userId" value="<%- req.staffUser.get('user_id') %>">
<input type="hidden" name="urlCancel" value="/staff/cancel/execute">
<input type="hidden" name="urlUpdateWatcherName" value="/staff/mypage/updateWatcherName">
<input type="hidden" name="messageAreYouSureCancel" value="<%- __('Message.AreYouSureCancel') %>">
<input type="hidden" name="messageConfirmCancelSelectedTickets" value="<%- __('Message.ConfirmCancelSelectedTickets') %>">

<script src="/js/staff/mypage.js"></script>

